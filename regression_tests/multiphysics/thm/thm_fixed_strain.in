SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE TH
    END
    SUBSURFACE_GEOMECHANICS geomech
      OPTIONS
        FLOW_COUPLING TWO_WAY_COUPLED
      /
    /
  /
END

SUBSURFACE

EXTERNAL_FILE ../subsurface_common.txt

#=========================== flow conditions ==================================
FLOW_CONDITION initial
  TYPE
    LIQUID_PRESSURE DIRICHLET
    TEMPERATURE DIRICHLET
  /
  ! 100 [psi] * 6893 [Pa/psi] = ~7.d5
  LIQUID_PRESSURE 7.d5
  TEMPERATURE 27.d0 ! based on Fig 6 in Kneafsey et al, 2023
END

FLOW_CONDITION injection_well
  TYPE
    RATE SCALED_VOLUMETRIC_RATE neighbor_perm
    TEMPERATURE DIRICHLET
  /
  RATE 100.0 cm^3/s
  TEMPERATURE 20.d0
/

FLOW_CONDITION out_flow_east
  TYPE
    LIQUID_PRESSURE DIRICHLET
    TEMPERATURE DIRICHLET
  /
  LIQUID_PRESSURE 7.d5
  TEMPERATURE 27.d0
/

#=========================== condition couplers ===============================
INITIAL_CONDITION
  FLOW_CONDITION initial
  REGION all
END

SOURCE_SINK injection_well
  FLOW_CONDITION injection_well
  REGION injection_borehole
END

BOUNDARY_CONDITION out_flow_east
  FLOW_CONDITION out_flow_east
  REGION east
END

END_SUBSURFACE

GEOMECHANICS

EXTERNAL_FILE ../geomech_common.txt

END_GEOMECHANICS
