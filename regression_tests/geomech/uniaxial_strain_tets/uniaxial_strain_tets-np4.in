SIMULATION
  SIMULATION_TYPE GEOMECHANICS_SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE richards
    / 
    GEOMECHANICS_SUBSURFACE geomech
      OPTIONS
        COUPLING ONE_WAY_COUPLED
      /
    /
  / 
END

SUBSURFACE

GRID
  TYPE UNSTRUCTURED_EXPLICIT ../meshes/uniaxial/tet/1d_tet.uge
END

TIME
  FINAL_TIME 5.0 d
  INITIAL_TIMESTEP_SIZE 0.001 d
  MAXIMUM_TIMESTEP_SIZE 1.0 d
END

MATERIAL_PROPERTY soil1
  ID 1
  CHARACTERISTIC_CURVES default
  POROSITY 0.25
  TORTUOSITY 1.0
  PERMEABILITY
    PERM_ISO 1.000d-12
  /
END

OUTPUT
END

FLUID_PROPERTY
  DIFFUSION_COEFFICIENT 1.000d-09
END

CHARACTERISTIC_CURVES default
  SATURATION_FUNCTION VAN_GENUCHTEN
   ALPHA 0.0001
   M 0.5
   LIQUID_RESIDUAL_SATURATION 0.1
   MAX_CAPILLARY_PRESSURE 100000000.0
  / 
  PERMEABILITY_FUNCTION MUALEM_VG_LIQ
   M 0.5
   LIQUID_RESIDUAL_SATURATION 0.1
  / 
END

REGION all
  COORDINATES
    -1.d20 -1.d20 -1.d20
    1.d20 1.d20 1.d20
  /
END

REGION bottom
  FILE ../meshes/uniaxial/tet/boundary_bottom.ex
END

REGION top
  FILE ../meshes/uniaxial/tet/boundary_top.ex
END

FLOW_CONDITION initial
  DATUM 0.0 0.0 0.0
  TYPE
    LIQUID_PRESSURE HYDROSTATIC
  END
    LIQUID_PRESSURE 103250.0
END

FLOW_CONDITION top_flow
  TYPE
    LIQUID_PRESSURE HYDROSTATIC
  END
    LIQUID_PRESSURE 103250.0
END

INITIAL_CONDITION initial
  FLOW_CONDITION initial
  REGION all
END

BOUNDARY_CONDITION top
  FLOW_CONDITION top_flow
  REGION top
END

BOUNDARY_CONDITION bottom
  FLOW_CONDITION top_flow
  REGION bottom
END

STRATA
  REGION all
  MATERIAL soil1
END

END_SUBSURFACE

GEOMECHANICS

GEOMECHANICS_GRID
  TYPE UNSTRUCTURED ../meshes/uniaxial/tet/1d_tet.ugi
  GRAVITY 0.0 0.0 -9.81 
END

GEOMECHANICS_MAPPING_FILE ../meshes/uniaxial/tet/1d_tet.mapping

GEOMECHANICS_REGRESSION
  VARIABLES
    DISPLACEMENT_Z
    STRAIN_ZZ
    STRESS_ZZ
  /
  VERTICES
    1
    2
    3
    4
    5
    6
    7
    8
    9
    10
    11
    12
    13
    14
    15
    16
    17
    18
    19
    20
    21
    22
    23
    24
    25
    26
    27
    28
    29
    30
    31
    32
    33
    34
    35
    36
    37
    38
    39
    40
    41
    42
    43
    44
  /
END

GEOMECHANICS_TIME
  COUPLING_TIMESTEP_SIZE 1 d
END

EXTERNAL_FILE ../meshes/uniaxial/tet/regions.txt

GEOMECHANICS_CONDITION west_geomech
  TYPE
    DISPLACEMENT_X DIRICHLET
  END
    DISPLACEMENT_X 0.0
END

GEOMECHANICS_CONDITION east_geomech
  TYPE
    DISPLACEMENT_X DIRICHLET
  END
    DISPLACEMENT_X 0.0
END

GEOMECHANICS_CONDITION north_geomech
  TYPE
    DISPLACEMENT_Y DIRICHLET
  END
    DISPLACEMENT_Y 0.0
END

GEOMECHANICS_CONDITION bottom_geomech
  TYPE
    DISPLACEMENT_Z DIRICHLET
  END
    DISPLACEMENT_Z 0.0
END

GEOMECHANICS_CONDITION south_geomech
  TYPE
    DISPLACEMENT_Y DIRICHLET
  END
    DISPLACEMENT_Y 0.0
END

GEOMECHANICS_BOUNDARY_CONDITION bottom_geomech
  GEOMECHANICS_CONDITION bottom_geomech
  GEOMECHANICS_REGION bottom_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION north_geomech
  GEOMECHANICS_CONDITION north_geomech
  GEOMECHANICS_REGION north_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION south_geomech
  GEOMECHANICS_CONDITION south_geomech
  GEOMECHANICS_REGION south_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION east_geomech
  GEOMECHANICS_CONDITION east_geomech
  GEOMECHANICS_REGION east_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION west_geomech
  GEOMECHANICS_CONDITION west_geomech
  GEOMECHANICS_REGION west_geomech
END

GEOMECHANICS_STRATA
  GEOMECHANICS_REGION all_geomech
  GEOMECHANICS_MATERIAL soil1
END

GEOMECHANICS_OUTPUT
END

GEOMECHANICS_MATERIAL_PROPERTY soil1
  ID 1
  ROCK_DENSITY 1.0
  YOUNGS_MODULUS 1000.0
  POISSONS_RATIO 0.0
  BIOT_COEFFICIENT 0.0
  THERMAL_EXPANSION_COEFFICIENT 0.0
END

END_GEOMECHANICS
